clear all
close all
clc
%% CEA data
%p = linspace(1,100,100);
p =[1 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100];
%Tcc = [3072.78  3164.44  3219.50  3259.20  3290.33  3315.98  3337.82  3356.84 3373.69  3388.83  3402.57  3415.16  3426.77  3437.54  3447.59  3457.02 3465.89  3474.26  3482.20  3489.74  3496.92  3503.77  3510.33  3516.62 3522.65  3528.46  3534.05  3539.44  3544.65  3549.68  3554.56  3559.28 3563.86  3568.30  3572.62  3576.82  3580.91  3584.88  3588.76  3592.54 3596.23  3599.84  3603.36  3606.80  3610.16  3613.45  3616.67  3619.82 3622.91  3625.94  3628.91  3631.82  3634.68  3637.49  3640.24  3642.95 3645.61  3648.22  3650.79  3653.31  3655.80  3658.24  3660.65  3663.01 3665.35  3667.64  3669.90  3672.13  3674.33  3676.50  3678.63  3680.74 3682.81  3684.86  3686.88  3688.88  3690.85  3692.79  3694.71  3696.60 3698.48  3700.32  3702.15  3703.96  3705.74  3707.50  3709.24  3710.97 3712.67  3714.36  3716.02  3717.67  3719.30  3720.91  3722.51  3724.09 3725.65  3727.20  3728.73  3730.24];
Tcc = [3072.78  3290.33 3388.83 3447.59 3489.74 3522.65 3549.68 3572.62 3592.54 3610.16 3625.94 3640.24 3653.31 3665.35 3676.50 3686.88 3696.60 3705.74 3714.36 3722.51 3730.24];
%Mmol = [14.854   14.987   15.068   15.127   15.173   15.212   15.245   15.273 15.299   15.322   15.343   15.362   15.380   15.396   15.412   15.426 15.440   15.453   15.465   15.477   15.488   15.499   15.509   15.519 15.528   15.537   15.546   15.554   15.563   15.571   15.578   15.586 15.593   15.600   15.607   15.613   15.620   15.626   15.632   15.638 15.644   15.649   15.655   15.661   15.666   15.671   15.676   15.681 15.686   15.691   15.696   15.700   15.705   15.709   15.714   15.718 15.722   15.726   15.730   15.735   15.738   15.742   15.746   15.750 15.754   15.757   15.761   15.765   15.768   15.772   15.775   15.778 15.782   15.785   15.788   15.792   15.795   15.798   15.801   15.804 15.807   15.810   15.813   15.816   15.819   15.822   15.824   15.827 15.830   15.833   15.835   15.838   15.841   15.843   15.846   15.848 15.851   15.853   15.856   15.858];
Mmol = [14.854  15.173 15.322 15.412 15.477 15.528 15.571 15.607 15.638 15.666 15.691 15.714 15.735 15.754 15.772 15.788 15.804 15.819 15.833 15.846 15.858];
%k = [1.1113   1.1144   1.1163   1.1176   1.1186   1.1195   1.1202   1.1208 1.1214   1.1219   1.1223   1.1227   1.1231   1.1234   1.1238   1.1241 1.1243   1.1246   1.1249   1.1251   1.1253   1.1255   1.1257   1.1259 1.1261   1.1263   1.1265   1.1267   1.1268   1.1270   1.1271   1.1273 1.1274   1.1276   1.1277   1.1278   1.1280   1.1281   1.1282   1.1283 1.1284   1.1285   1.1286   1.1287   1.1288   1.1290   1.1290   1.1291 1.1292   1.1293   1.1294   1.1295   1.1296   1.1297   1.1298   1.1298 1.1299   1.1300   1.1301   1.1302   1.1302   1.1303   1.1304   1.1305 1.1305   1.1306   1.1307   1.1307   1.1308   1.1309   1.1309   1.1310 1.1310   1.1311   1.1312   1.1312   1.1313   1.1313   1.1314   1.1315 1.1315   1.1316   1.1316   1.1317   1.1317   1.1318   1.1318   1.1319 1.1319   1.1320   1.1320   1.1321   1.1321   1.1322   1.1322   1.1323 1.1323   1.1324   1.1324   1.1324];
k2= [1.2142  1.2063 1.2029 1.2009 1.1994 1.1984 1.1975 1.1967 1.1961 1.1955 1.1950 1.1945 1.1941 1.1937 1.1934 1.1930 1.1927 1.1924 1.1922 1.1919 1.1917];

P_son = [1 10 20 30 40 50 60 70 80 90 100];
rho = [3.6135e-2  3.3484e-1 6.5714e-1 9.7513e-1 1.2904 1.6038 1.9156 2.2262 2.5357 2.8444 3.1522  ];
Son_vel = [1375.3  1393.0 1407.4 1415.7 1421.6 1426.1 1429.7 1432.7 1435.4 1437.7 1439.7];
%% Interpolation
x = linspace(1,100,1000);

f_T = spline(p,Tcc);
yT = ppval(f_T, x);


f_M = spline(p,Mmol);
yM = ppval(f_M, x);

f_g = spline(p,k2);
yg = ppval(f_g, x);

f_Sv = spline(P_son,Son_vel);
ySv = ppval(f_Sv, x);  %[m/s]

f_rho = spline(P_son,rho);
yrho = ppval(f_rho,x);  %[kg/m^3]


% % Plots
% lw=2;
% 
% figure(1)
% subplot(1,3,1)
% plot(x,yT,'Linewidth',lw)
% hold on
% scatter(p,Tcc,'o')
% xlabel('Pressure [bar]')
% ylabel('T_{CC} [K]')
% grid on
% 
% 
% subplot(1,3,2)
% plot(x,yM,'k','Linewidth',lw)
% xlabel('Pressure [bar]')
% ylabel('M_{mol} [g/mol]')
% hold on
% scatter(p,Mmol,'o')
% grid on
% 
% 
% subplot(1,3,3)
% plot(x,yg,'g','Linewidth',lw)
% hold on
% scatter(p,k2,'o')
% xlabel('Pressure [bar]')
% ylabel('k')
% grid on
% 
% %%
% figure()
% plot(x,ySv)
% hold on
% scatter(P_son,Son_vel,'o')
% xlabel('Pressure [bar]')
% ylabel('Sonic velocity [m/s]')
% hold on
% plot(P_son,Son_vel)
% 
% figure()
% plot(x,yrho)
% hold on
% plot(P_son,rho,'o')
% xlabel('Pressure [bar]')
% ylabel('Density [kg/m^3]')